<!DOCTYPE html SYSTEM "about:legacy-compat">
<!-- saved from url=(0092)http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html -->
<html lang="en-US">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>Migrating to Java 8</title>
    <link rel="stylesheet" href="./styles.min.css">
    <script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="main.build"
            src="./main.build.js"></script>
    <style id="style-1-cropbar-clipper">/* Copyright 2014 Evernote Corporation. All rights reserved. */
    .en-markup-crop-options {
    top: 18px !important;
    left: 50% !important;
    margin-left: -100px !important;
    width: 200px !important;
    border: 2px rgba(255,255,255,.38) solid !important;
    border-radius: 4px !important;
}

.en-markup-crop-options div div:first-of-type {
    margin-left: 0px !important;
}
</style></head><body data-id="Migrating_to_Java_8"><div class="wrapper"><section class="panel _nav"><header class="panel__header"><div class="container"><form class="search-box"><label for="search-box__input" class="search-box__label"><input type="text" class="search-box__input" id="search-box__input" placeholder="Search IntelliJ IDEA Help" autocomplete="off"></label><div class="search-box__clear" title="Clear"></div></form></div></header><nav class="panel__content"><div class="container _nav"><menu class="nav-tree"><ul class="nav-tree__list"><li class="nav-tree__item _branch _opened"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId0.html" class="nav-tree__link">IntelliJ IDEA</a><div class="nav-tree__item-expander"></div><ul class="nav-tree__list"><li class="nav-tree__item _branch _opened"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId202.html" class="nav-tree__link">Manuals</a><div class="nav-tree__item-expander"></div><ul class="nav-tree__list"><li class="nav-tree__item _branch _opened"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/application_gevelopment_guidelines.html" class="nav-tree__link">Language and Framework-Specific Guidelines</a><div class="nav-tree__item-expander"></div><ul class="nav-tree__list"><li class="nav-tree__item _branch _opened"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Java_SE.html" class="nav-tree__link">Java SE</a><div class="nav-tree__item-expander"></div><ul class="nav-tree__list"><li class="nav-tree__item _active _opened _branch"><a href="./MigratingtoJava8_files/MigratingtoJava8.html" class="nav-tree__link">Migrating to Java 8</a><ul class="nav-tree__list"></ul><div class="nav-tree__item-expander"></div></li></ul></li></ul></li></ul></li></ul></li></ul></menu></div><div class="container _footer panel__footer"><p><a href="mailto:webmaster@jetbrains.com">Send feedback</a></p></div></nav><div class="menu-spinner" style="display: none;"></div></section><main class="panel _main"><header class="panel__header _fixed"><div class="container"><h3>IntelliJ IDEA 15.0.0 Help</h3><div class="panel__header-placeholder">/<strong>Migrating to Java 8</strong></div><div class="shortcuts-switcher" style="display: none;"><label for="switch-shortcuts">Keymap:</label><label class="select _shortcuts" style="width: 135px;"><span class="select__button"><span class="select__text">Default (Mac OS X 10.5+)</span></span><select id="switch-shortcuts" class="select _shortcuts select__input" height="1"><option data-group="primary" value="default" selected="">Default (Windows/Linux)</option><option data-group="primary" value="default_for_gnome">GNOME</option><option data-group="primary" value="default_for_kde">KDE</option><option data-group="primary" value="default_for_xwin">XWindow</option><option data-group="primary" value="emacs">Emacs</option><option data-group="primary" value="jbuilder">JBuilder</option><option data-group="primary" value="visual_studio">Visual Studio</option><option data-group="primary" value="netbeans_6.5">NetBeans 6.5</option><option data-group="primary" value="eclipse">Eclipse</option><option data-group="secondary" value="mac_os_x_10.5_">Default (Mac OS X 10.5+)</option><option data-group="secondary" value="mac_os_x">OS X</option><option data-group="secondary" value="eclipse_mac_os_x">OS X Eclipse</option><option data-group="secondary" value="intellij_idea_classic_os_x">IntelliJ IDEA Classic (OS X)</option><option data-group="secondary" value="xcode">Xcode</option><option data-group="secondary" value="visual_studio">Visual Studio</option><option data-group="secondary" value="resharper">ReSharper</option><option data-group="secondary" value="resharper_osx">ReSharper OSX</option><option data-group="secondary" value="emacs">Emacs</option></select></label></div><div class="panel-trigger"></div></div><div class="content-spinner"><div class="content-spinner__item"></div><div class="content-spinner__item"></div><div class="content-spinner__item"></div><div class="content-spinner__item"></div><div class="content-spinner__item"></div></div></header><div class="panel__header _emulator" style="height: 28px;"></div><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="false"><div class="navigation-links _top"><a class="navigation-links__prev" href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Java_SE.html">Java SE</a><a class="navigation-links__next" href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId10000001.html">Java EE</a></div><h1>Migrating to Java 8</h1><p>Keeping your code base up to date with the latest versions of languages and libraries is a challenging task.
        Fortunately, IntelliJ IDEA can make this easier, with inspections to guide your efforts, automatic fixes, and
        the usual refactoring tools.
    </p><p>Java SE 8 is the largest change in the language, at least since Java 5, if not in the history of Java. Java 8
        brings entire new concepts to the language, like lambda expressions, and adds new methods to classes that
        developers have been using comfortably for years. In addition, there are new ways of doing things, including the
        new Date and Time API, and an Optional type to help with null-safety.
    </p><p>In this tutorial we’re going to show how IntelliJ IDEA can help you transition your codebase from Java 6 to Java
        8, using code examples to show what help is available and when you may, or may not, choose to use new features.
    </p><p>This tutorial assumes the following prerequisites:
        </p><ul class="list _bullet"><li class="list__item">You already have an IntelliJ IDEA project for an existing code base.</li></ul>
    <p></p><p>On this page:</p><ul><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e24">Approaching the problem</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e42">Initial setup</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e59">Configuring and running language level migration inspections</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e110">Lambda expressions</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e152">Impact of replacing with lambda expressions</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e205">New Collection Methods</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e245">Streams API - foreach</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e272">Streams API - collect</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e302">Impact of replacing foreach with Streams</a></li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/Migrating_to_Java_8.html#d12397e337">Summary</a></li></ul><a name="d12397e24"></a><a name="dynaProc0"></a><section class="procedure-steps"><h2>Approaching the problem</h2><p>
            </p><p>The sheer number of options and features that IntelliJ IDEA has available might be overwhelming,
                especially when tackling a problem as big as trying to migrate a whole code base (or even just a module
                or package) to a new version. As with most software development problems, it pays to approach this in an
                iterative fashion.
            </p>
        <p></p><ol class="list _decimal"><li class="list__item">Pick a small number of changes to implement</li><li class="list__item">Pick a section of the codebase to apply them to</li><li class="list__item">Apply the changes in batches, running your project tests frequently and checking in to your VCS system
            when the tests are green.
        </li></ol><p class="procIntro">
            </p><p>To this end, this tutorial will group changes into sections rather than assume a Big Bang approach.</p>
        <p></p></section><a name="d12397e42"></a><a name="dynaProc1"></a><section class="procedure-steps"><h2>Initial setup</h2><ol class="list _decimal"><li class="list__item">Make sure you’re compiling with a Java 8 SDK. If you’re not,
            <a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId324.html"><span>change your SDK</span></a>
            to the latest version of Java 8.
        </li><li class="list__item">In the<a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId2273.html"><span>project settings</span></a>, you should set your language level to “8.0 - Lambdas,
            type annotations"
        </li></ol><p class="procIntro">
            </p><p>If you are compiling the code in a CI environment, you’ll need to ensure the new code is compiled using
                Java 8 there as well. Configuring this is beyond the scope of this tutorial.
            </p>
        <p></p></section><a name="d12397e59"></a><a name="dynaProc2"></a><section class="procedure-steps"><h2>Configuring and running language level migration inspections</h2><p>
            </p><p>Your project may, or may not, make use of inspections to encourage a certain level
                of consistency and quality in the code. To focus purely on just making changes related to upgrading to
                Java 8, we're going to create a new inspection profile.
            </p>
        <p></p><ol class="list _decimal"><li class="list__item">Navigate to the
            <a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId701.html"><span>inspections settings</span></a>
        </li><li class="list__item">
            <a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId703.html"><span>Create a new inspection profile</span></a>
            called "Java8".
        </li><li class="list__item">
            As a starting point for this profile, deselect everything using the “reset to empty” button
        </li><li class="list__item">INSERT PICTURE</li><li class="list__item">We're going to select a set of language migration inspections to investigate</li><li class="list__item">INSERT PICTURE {MigrationInspections}</li><li class="list__item">These inspections will show us areas in your code where you may be able to use the following Java 8
            features:
            <ul class="list _ul"><li class="list__item">Lambda expressions</li><li class="list__item">Method references</li><li class="list__item">New Collections methods</li><li class="list__item">Streams API</li></ul>
        </li><li class="list__item">Click OK to save these settings to the "Java8" profile and close the settings window.</li><li class="list__item"><a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId713.html"><span>Run the inspections</span></a>, selecting the "Java8" profile and the scope to run
            the inspections on. If your project is small, that might be the whole codebase, but more likely you will
            want to select a module or package to start with.
        </li></ol><p class="procIntro">
            </p><p>
                Once “Analyse code” has finished running, you’ll see a set of results in the
                <a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId2345.html"><span>Inspection Tool Window</span></a>.
            </p>
        <p></p></section><a name="d12397e110"></a><a name="dynaProc3"></a><section class="procedure-steps"><h2>Lambda expressions</h2><p>
            </p><p>The inspections will show you places where you can convert code automatically to use lambda expressions.
                There are a number of places you might typically discover this in your existing code, for example when
                you create anonymous inner classes for:
                </p><ul class="list _ul"><li class="list__item">Runnable, Callable</li><li class="list__item">Comparator</li><li class="list__item">FileFilter, PathMatcher</li><li class="list__item">EventHandler</li><li class="list__item">Third party interfaces like Guava’s Predicate</li></ul>
            <p></p>
        <p></p><ol class="list _decimal"><li class="list__item">In the<a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId2345.html"><span>Inspection Tool Window</span></a>, you should see results grouped under "Java
            language level migration aids". Under this heading, you may see "Anonymous type can be replaced with
            lambda". Open up this heading to see all the sections of the code where IntelliJ IDEA has detected you can
            use a lambda.
        </li><li class="list__item">For example, you may come across a Runnable anonymous inner class:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">executorService</span><span class="o">.</span><span class="na">scheduleAtFixedRate</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">getDs</span><span class="o">().</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="n">CappedPic</span><span class="o">(</span><span class="n">title</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">},</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">500</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">MILLISECONDS</span><span class="o">);</span>
</code></div>
        </li><li class="list__item">Many inspections suggest a fix that can be applied, and "Anonymous type can be replaced with
            lambda" does have a suggested resolution. To apply the fix, either:
             
            <ul class="list _ul"><li class="list__item">Click on the “Problem Resolution” in the right of the inspection window, in our case this is
                    “Replace with lambda"
                </li><li class="list__item">Alt + enter on the grey code in the editor and select “Replace with lambda”.</li></ul>
        </li><li class="list__item">IntelliJ IDEA will then automatically change the code above to use a lambda expression:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">executorService</span><span class="o">.</span><span class="na">scheduleAtFixedRate</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">getDs</span><span class="o">().</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="n">CappedPic</span><span class="o">(</span><span class="n">title</span><span class="o">)),</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">500</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">MILLISECONDS</span><span class="o">);</span></code></div>
        </li></ol></section><a name="d12397e152"></a><h2>Impact of replacing with lambda expressions</h2>
            <p>You should be able to automatically apply this fix to all places where anonymous inner classes are found
                in your codebase without impacting the functionality in your system. Applying the change will generally
                also improve the readability of your code, removing lines of boilerplate (as in the example above).
            </p>
            <p>
                However, you may want to check each individual change, as:
                </p><ul class="list _ul"><li class="list__item">Larger anonymous inner classes may not be very readable in a lambda form</li><li class="list__item">There may be additional changes and improvements you can make</li></ul>
            <p></p>
            <p>Let’s address both points with an example.</p>
        <p>We might be using a runnable to group a specific set of assertions in our test:
            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">Runnable</span> <span class="n">runnable</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">datastoreProvider</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">database</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertNull</span><span class="o">(</span><span class="n">database</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id"</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">get</span><span class="o">());</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertNull</span><span class="o">(</span><span class="n">database</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id"</span><span class="o">,</span> <span class="mi">3</span><span class="o">).</span><span class="na">get</span><span class="o">());</span>

        <span class="n">User</span> <span class="n">foundUser</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id"</span><span class="o">,</span> <span class="mi">2</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">(</span><span class="n">foundUser</span><span class="o">);</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">(</span><span class="n">database</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id"</span><span class="o">,</span> <span class="mi">4</span><span class="o">).</span><span class="na">get</span><span class="o">());</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="s">"Should find 1 friend"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">foundUser</span><span class="o">.</span><span class="na">friends</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="s">"Should find the right friend"</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="n">foundUser</span><span class="o">.</span><span class="na">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">id</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">};</span>
</code></div>
        <p></p>
        <p>
            Converting this to a lambda results in:
            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">Runnable</span> <span class="n">runnable</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">datastoreProvider</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">database</span><span class="o">);</span>
    <span class="n">Assert</span><span class="o">.</span><span class="na">assertNull</span><span class="o">(</span><span class="n">database</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id"</span><span class="o">,</span> <span class="mi">1</span><span class="o">).</span><span class="na">get</span><span class="o">());</span>
    <span class="n">Assert</span><span class="o">.</span><span class="na">assertNull</span><span class="o">(</span><span class="n">database</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id"</span><span class="o">,</span> <span class="mi">3</span><span class="o">).</span><span class="na">get</span><span class="o">());</span>

    <span class="n">User</span> <span class="n">foundUser</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id"</span><span class="o">,</span> <span class="mi">2</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
    <span class="n">Assert</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">(</span><span class="n">foundUser</span><span class="o">);</span>
    <span class="n">Assert</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">(</span><span class="n">database</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"id"</span><span class="o">,</span> <span class="mi">4</span><span class="o">).</span><span class="na">get</span><span class="o">());</span>
    <span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="s">"Should find 1 friend"</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">foundUser</span><span class="o">.</span><span class="na">friends</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
    <span class="n">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="s">"Should find the right friend"</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="n">foundUser</span><span class="o">.</span><span class="na">friends</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">id</span><span class="o">);</span>
<span class="o">};</span>
</code></div>
            This is not much shorter, nor does it impact readability much.
        <p></p>
        <p>In cases like these, you may choose to use IntelliJ IDEA’s extract method to pull these
            lines into a single method instead:
            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">Runnable</span> <span class="n">runnable</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">assertUserMatchesSpecification</span><span class="o">(</span><span class="n">database</span><span class="o">,</span> <span class="n">datastoreProvider</span><span class="o">);</span>
<span class="o">};</span>
</code></div>
        <p></p>
         
        <p>The second reason to check all your lambda conversions is that some lambdas can be further simplified.
            This last example is one of them - you can see this as IntelliJ IDEA will show the curly braces in grey, and
            pressing Alt + Enter with the cursor on the braces will pop up the suggested change “Statement lambda can be
            replaced with expression lambda":
        </p>
        <p>PICTURE {StatementLambdaCanNowBe}</p>
        <p>Accepting this change will result in:
            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">Runnable</span> <span class="n">runnable</span> <span class="o">=</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="n">assertUserMatchesSpecification</span><span class="o">(</span><span class="n">database</span><span class="o">,</span> <span class="n">datastoreProvider</span><span class="o">);</span></code></div>
        <p></p>
        <p>Once you’ve changed your anonymous inner classes to lambdas and made any manual adjustments you might want
            to make, like extracting methods or reformatting the code, run all your tests to make sure everything still
            works. If so, commit these changes to VCS. Once you’ve done this, you’ll be ready to move to the next step.
        </p>
    <a name="d12397e205"></a><a name="dynaProc4"></a><section class="procedure-steps"><h2>New collection methods</h2><p>
            </p><p>
                Java 8 introduced a new way of working with collections of data, through the Streams API. What’s less
                well known is that many of the
                <code class="code" data-lang="Java">Collection</code>
                classes we’re used to working
                with have new methods on them that are not via the streams API. For example, java.util.Iterable has a
                forEach method that lets you pass in a lambda that represents an operation to run on every element in
                the Iterable. IntelliJ IDEA’s inspections will highlight areas where you can use this and other new
                methods.
            </p>
        <p></p><ol class="list _decimal"><li class="list__item">Back in the<a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId2345.html"><span>Inspection Tool Window</span></a>, you should see "foreach can be collapsed
            with stream api" under "Java language level migration aids". You may not realise when you're going
            through all the inspections, but not all of these fixes will use the Streams API (more on Streams later).
            For example:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="k">for</span> <span class="o">(</span><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Annotation</span> <span class="o">&gt;</span> <span class="n">annotation</span> <span class="o">:</span> <span class="n">INTERESTING_ANNOTATIONS</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">addAnnotation</span><span class="o">(</span><span class="n">annotation</span><span class="o">);</span>
<span class="o">}</span>
</code></div>
        </li><li class="list__item">
            IntelliJ IDEA suggests “Can be replaced with foreach call”. Applying this inspection gives us:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">INTERESTING_ANNOTATIONS</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">addAnnotation</span><span class="o">);</span></code></div>
             
            Note that IntelliJ IDEA has applied all simplifications it could, going as far as using a Method Reference
            rather
            than a lambda. Method references are another new features in Java 8, which can generally be used where a
            lambda expression would usually call a single method.
        </li><li class="list__item">
            Method references take a while to get used to, so you may prefer to expend this into a lambda to see the
            lambda version:
        </li><li class="list__item">IMAGE</li><li class="list__item">Alt+ enter on the method reference and click “replace method reference with lambda”. This is especially
            useful as you get used to all the new syntax. In lambda form, it looks like:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">INTERESTING_ANNOTATIONS</span><span class="o">.</span><span class="na">forEach</span><span class="o">((</span><span class="n">annotation</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">addAnnotation</span><span class="o">(</span><span class="n">annotation</span><span class="o">));</span></code></div>
        </li></ol><p class="procIntro">
            Both of the new forms do exactly the same thing as the original code - for every item in the
            <code class="code" data-lang="Java">INTERESTING_ANNOTATIONS</code>
            list, it calls
            <code class="code" data-lang="Java">addAnnotation</code>
            with the item.
        </p></section><a name="d12397e245"></a><a name="dynaProc5"></a><section class="procedure-steps"><h2>Streams API - foreach</h2><p>
             
            </p><p>
                IntelliJ IDEA’s inspections will suggest using the forEach on Iterable where appropriate, but it will
                also the new Streams API where this is a better choice.
            </p>
            <p>
                The Streams API is a powerful tool for querying and manipulating data, and using it could
                significantly change (and simplify) the code you write. For this tutorial, we’re going to look at some
                of the simplest use cases to get you started. Once you’re more comfortable using this style of coding,
                you may then want to use its capabilities further.
            </p>
        <p></p><ol class="list _decimal"><li class="list__item">What does the Streams API give us that we can't simply get from using a forEach method? Let's look at an
            example that’s a slightly more complicated for loop than the previous one:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">addAllBooksToLibrary</span><span class="o">(</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;</span> <span class="n">books</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">books</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">books</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Book</span> <span class="n">book</span><span class="o">:</span> <span class="n">books</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">book</span><span class="o">.</span><span class="na">isInPrint</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">library</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">book</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></div>
            Firstly the loop body checks some condition, then does something with the items that pass that condition.
        </li><li class="list__item">
            Selecting the fix “Replace with forEach” will use the Streams API to do the same thing:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">addAllBooksToLibrary</span><span class="o">(</span><span class="n">Set</span> <span class="o">&lt;</span><span class="n">Book</span><span class="o">&gt;</span> <span class="n">books</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">books</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">books</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="n">books</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
             <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">book</span> <span class="o">-&gt;</span> <span class="n">book</span><span class="o">.</span><span class="na">isInPrint</span><span class="o">())</span>
             <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">library</span><span class="o">::</span><span class="n">add</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></div>
            Again, it selects a method reference for the forEach parameter. For the other stream operations, in this
            case,
            filter, IntelliJ IDEA has used a lambda, but will suggest in the editor that this particular example can use a
            method reference:
        </li><li class="list__item">IMAGE</li><li class="list__item">Applying this fix gives:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">books</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
     <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">Book</span><span class="o">::</span><span class="n">isInPrint</span><span class="o">)</span>
     <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">library</span><span class="o">::</span><span class="n">add</span><span class="o">);</span>
</code></div>
        </li></ol></section><a name="d12397e272"></a><a name="dynaProc6"></a><section class="procedure-steps"><h2>Streams API - collect</h2><p>
            </p><p>Instead of “can be replaced with foreach” call you might see “can be replaced with collect call”. This is
                very similar to the above example, but instead of calling a forEach method at the end of the stream and
                performing some operation, this will use the Stream’s collect method to put all the results from the
                Stream operation into a new Collection. It’s very common in code to see a for loop that iterates over
                some collection, performs some sort of filtering or manipulating, and outputs the results into a new
                collection, and that's the sort of code this inspection will identify and migrate to using Streams.
            </p>
        <p></p><ol class="list _decimal"><li class="list__item">
            In the <a href="http://localhost:63342/IDEA%20Family%20Products%20Help%20v2/preview/topicId2345.html"><span>Inspection Tool Window</span></a>, you should see "foreach can be replaced with
            collect call" under "Java language level migration aids". Selecting one of these inspection results will
            show you a for loop that might look something like:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">List</span> <span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="o">....</span>

<span class="n">List</span> <span class="o">&lt;</span><span class="n">Key</span><span class="o">.</span><span class="na">Id</span><span class="o">&gt;</span> <span class="n">objIds</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">.</span><span class="na">Id</span><span class="o">&gt;();</span>
<span class="k">for</span> <span class="o">(</span><span class="n">Key</span> <span class="n">key</span> <span class="o">:</span> <span class="n">keys</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">objIds</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="o">}</span>
</code></div>
            Here, we’re looping over a list of Key objects, getting the Id from each of these objects, and putting them
            all into
            a separate collection of objIds.
        </li><li class="list__item">Apply the “Replace with collect” fix to turn this code into:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">.</span><span class="na">Id</span><span class="o">&gt;</span> <span class="n">objIds</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="n">Key</span><span class="o">::</span><span class="n">getId</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span></code></div>
        </li><li class="list__item">Reformat this code so that you can more clearly see all the Stream operations:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">List</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">.</span><span class="na">Id</span><span class="o">&gt;</span> <span class="n">objIds</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                          <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">Key</span><span class="o">::</span><span class="n">getId</span><span class="o">)</span>
                          <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="n">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
</code></div>
            This does exactly the same thing the original code did - takes a collection of Keys, “maps” each Key to its
            Id, and
            collects those into a new list, objIds.
        </li></ol><p class="procIntro">
            </p><p>Like the foreach example, IntelliJ IDEA can work out if a filter needs applying to a collect statement as
                well as maps, so it can cleverly turn many of your loops into a set of Stream calls.
            </p>
        <p></p></section><a name="d12397e302"></a><h2>Impact of replacing foreach with streams</h2>
        <p>
            It may be tempting to run these inspections and simply apply all. When it comes to converting your code
            to use new methods on collections or Streams, a little care should be taken. The IDE will ensure that
            your code works the same way it used to, but you need to check that your code remains readable and
            understandable after applying the changes. If you and your team are using Java 8 features for the first
            time, some of the new code will be very unfamiliar and probably unclear. Take the time to look at each
            change individually and check you’re happy you understand the new code before going ahead.
        </p>
        <p>
            Like with lambdas, a good rule of thumb is to start with small sections of code - short for loops that
            translate into two or less stream operations, preferably with single-line lambdas. As you become more
            familiar with the methods, then you may want to tackle more complex code.
        </p>
        <p>Let's look at an example:</p>
        <p>
            IntelliJ IDEA suggests that this code:
            </p><div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="k">for</span> <span class="o">(</span><span class="n">Entry</span><span class="o">&lt;</span><span class="n">Class</span> <span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Annotation</span><span class="o">&gt;,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Annotation</span><span class="o">&gt;&gt;</span> <span class="n">e</span> <span class="o">:</span> <span class="n">getRelevantAnnotations</span><span class="o">().</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Annotation</span> <span class="n">annotation</span><span class="o">:</span> <span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">destMC</span><span class="o">.</span><span class="na">addAnnotation</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">annotation</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span> 
</code></div>
            Can be converted to this code:
            <div class="code-block" data-lang="Java"><code class="code-block__wrapper"><span class="n">getRelevantAnnotations</span><span class="o">().</span><span class="na">entrySet</span><span class="o">()</span>
                        <span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">())</span>
                        <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
                            <span class="k">for</span> <span class="o">(</span><span class="n">Annotation</span> <span class="n">annotation</span><span class="o">:</span> <span class="n">e</span><span class="o">.</span><span class="na">getValue</span><span class="o">())</span> <span class="o">{</span>
                                <span class="n">destMC</span><span class="o">.</span><span class="na">addAnnotation</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">annotation</span><span class="o">);</span>
                            <span class="o">}</span>
                        <span class="o">});</span>
</code></div>
            Setting aside the fact that the original code is challenging to understand to begin with, you may choose not
            to apply the changes for a number of reasons:
            <ul class="list _ul"><li class="list__item">Despite refactoring away the outer-loop, there’s still a foreach loop inside the forEach method.
                    This suggests
                    that there may be a different way to structure the stream call, maybe using flatmap
                </li><li class="list__item">The destMC.addAnnotation method suggests that there may be a way to restructure this to use a
                    collect call rather
                    than a forEach
                </li><li class="list__item">It’s arguably not easier to understand than the original code</li></ul>
            However, you may choose to accept this change for the following reasons:
            <ul class="list _ul"><li class="list__item">This is a complex piece of code that is iterating through and manipulating data in a collection,
                    therefore a move
                    towards the Streams API is a move in the right direction. It can be further refactored or improved
                    later when the
                    team’s developers are more familiar with the way Streams work.
                </li><li class="list__item">In the new code the “if” condition has been moved into a “filter” call, making marginally clearer
                    what purpose
                    some sections of the code serve
                </li></ul>
            Apart from the options “keep the code” and “apply the changes”, there’s a third option: refactor the old
            code to
            something more readable, even if it doesn’t use Java 8. This might be a good piece of code to make a note of
            to
            refactor later, rather than trying to tackle all the code’s problems while simply trying to adopt more
            Java 8 conventions.
        <p></p>
    <a name="d12397e337"></a><h2>Summary</h2>
        <p>
        IntelliJ IDEA's Inspections, in particular those around language migration, can help you identify areas in your
        code base that can be refactored to use Java 8 features, and even apply those fixes automatically.
        </p><p>
            It's valuable to look at the updated code if you have applied these fixes automatically, so you can
        check it doesn't make your code harder to understand, and to help you become familiar with the new features.
        </p>
        <p>
            This tutorial barely scratches the surface of the subject of migrating your code. We've covered lambda
            expressions, method references, some new methods on Collections and introduced the new Streams API. Not
            only can these features give you much more power and readability when you learn more about them, but
            there are other features that we did not cover. For example, you could use the "Use of obsolete Date-Time
            API" inspection to find places to use the new Date and Time API. Or you can use the various inspections
            that check for the use of "null" in the code to point you towards areas that might benefit from using the
            new Optional type.
        </p>
        <p>
            In summary, there are plenty of new features in Java 8 designed to make life easier for programmers - to
            make code more readable, and to make it easier to perform complex operations on data structures.
            IntelliJ IDEA of course not only supports these features, but helps developers make use of them, including
            migrating existing code and providing help and suggestions in the editor to guide you as you use them.
        </p>

    <div class="last-modified">Last modified: 14 October 2015 </div></article><div id="disqus_thread"></div></div></section></main></div><script data-main="http://helpserver.labs.intellij.net:8080/help-app/js/main.build" src="./MigratingtoJava8_files/require.js"></script><script id="hiddenlpsubmitdiv" style="display: none;"></script><script>try{for(var lastpass_iter=0; lastpass_iter < document.forms.length; lastpass_iter++){ var lastpass_f = document.forms[lastpass_iter]; if(typeof(lastpass_f.lpsubmitorig2)=="undefined"){ lastpass_f.lpsubmitorig2 = lastpass_f.submit; if (typeof(lastpass_f.lpsubmitorig2)=='object'){ continue;}lastpass_f.submit = function(){ var form=this; var customEvent = document.createEvent("Event"); customEvent.initEvent("lpCustomEvent", true, true); var d = document.getElementById("hiddenlpsubmitdiv"); if (d) {for(var i = 0; i < document.forms.length; i++){ if(document.forms[i]==form){ if (typeof(d.innerText) != 'undefined') { d.innerText=i.toString(); } else { d.textContent=i.toString(); } } } d.dispatchEvent(customEvent); }form.lpsubmitorig2(); } } }}catch(e){}</script></body></html>